@{
    ViewData["Title"] = "Home";
}

<!-- Hero Section -->
<section class="hero-section bg-gradient text-white py-5 mb-5">
    <div class="container py-5">
        <div class="row align-items-center">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <h1 class="display-3 fw-bold mb-4">Transform Your Marketing with SMS, MMS & Email</h1>
                <p class="lead mb-4">
                    A powerful, enterprise-grade marketing platform to reach your customers where they are. 
                    Send targeted campaigns, track performance, and grow your business.
                </p>
                <div class="d-flex gap-3 flex-wrap">
                    <a href="@Url.Action("Register", "Auth")" class="btn btn-light btn-lg px-4">
                        <i class="bi bi-person-plus"></i> Get Started Free
                    </a>
                    <a href="#features" class="btn btn-outline-light btn-lg px-4">
                        <i class="bi bi-arrow-down-circle"></i> Learn More
                    </a>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="hero-image-placeholder bg-white bg-opacity-10 rounded-3 p-5 text-center">
                    <i class="bi bi-megaphone" style="font-size: 10rem; opacity: 0.3;"></i>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Features Section -->
<section id="features" class="features-section py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold mb-3">Powerful Features for Modern Marketing</h2>
            <p class="lead text-muted">Everything you need to create, manage, and optimize your campaigns</p>
        </div>
        
        <div class="row g-4">
            <!-- Feature 1: Multi-Channel Campaigns -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm hover-lift">
                    <div class="card-body p-4">
                        <div class="feature-icon bg-primary bg-opacity-10 text-primary rounded-3 p-3 mb-3 d-inline-block">
                            <i class="bi bi-broadcast" style="font-size: 2rem;"></i>
                        </div>
                        <h4 class="card-title mb-3">Multi-Channel Campaigns</h4>
                        <p class="card-text text-muted">
                            Send SMS, MMS, and Email campaigns from one unified platform. 
                            Reach your audience on their preferred channels.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Feature 2: Advanced Analytics -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm hover-lift">
                    <div class="card-body p-4">
                        <div class="feature-icon bg-success bg-opacity-10 text-success rounded-3 p-3 mb-3 d-inline-block">
                            <i class="bi bi-graph-up-arrow" style="font-size: 2rem;"></i>
                        </div>
                        <h4 class="card-title mb-3">Advanced Analytics</h4>
                        <p class="card-text text-muted">
                            Track campaign performance in real-time with detailed analytics and reporting. 
                            Make data-driven decisions to optimize your results.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Feature 3: Automation & Scheduling -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm hover-lift">
                    <div class="card-body p-4">
                        <div class="feature-icon bg-info bg-opacity-10 text-info rounded-3 p-3 mb-3 d-inline-block">
                            <i class="bi bi-clock-history" style="font-size: 2rem;"></i>
                        </div>
                        <h4 class="card-title mb-3">Automation & Scheduling</h4>
                        <p class="card-text text-muted">
                            Schedule campaigns in advance and automate your marketing workflows. 
                            Save time and improve efficiency.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Feature 4: Contact Management -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm hover-lift">
                    <div class="card-body p-4">
                        <div class="feature-icon bg-warning bg-opacity-10 text-warning rounded-3 p-3 mb-3 d-inline-block">
                            <i class="bi bi-people" style="font-size: 2rem;"></i>
                        </div>
                        <h4 class="card-title mb-3">Contact Management</h4>
                        <p class="card-text text-muted">
                            Organize your contacts with dynamic groups and tags. 
                            Segment your audience for targeted messaging.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Feature 5: Template Library -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm hover-lift">
                    <div class="card-body p-4">
                        <div class="feature-icon bg-danger bg-opacity-10 text-danger rounded-3 p-3 mb-3 d-inline-block">
                            <i class="bi bi-file-earmark-text" style="font-size: 2rem;"></i>
                        </div>
                        <h4 class="card-title mb-3">Template Library</h4>
                        <p class="card-text text-muted">
                            Create reusable message templates with dynamic variables. 
                            Personalize content at scale.
                        </p>
                    </div>
                </div>
            </div>

            <!-- Feature 6: Compliance & Security -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 border-0 shadow-sm hover-lift">
                    <div class="card-body p-4">
                        <div class="feature-icon bg-secondary bg-opacity-10 text-secondary rounded-3 p-3 mb-3 d-inline-block">
                            <i class="bi bi-shield-check" style="font-size: 2rem;"></i>
                        </div>
                        <h4 class="card-title mb-3">Compliance & Security</h4>
                        <p class="card-text text-muted">
                            Stay compliant with GDPR, CAN-SPAM, and TCPA regulations. 
                            Enterprise-grade security for your data.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Stats Section -->
<section class="stats-section py-5 bg-light">
    <div class="container">
        <div class="row text-center g-4">
            <div class="col-md-3 col-6">
                <div class="stat-item">
                    <h2 class="display-4 fw-bold text-primary mb-2">10M+</h2>
                    <p class="text-muted mb-0">Messages Sent</p>
                </div>
            </div>
            <div class="col-md-3 col-6">
                <div class="stat-item">
                    <h2 class="display-4 fw-bold text-success mb-2">98%</h2>
                    <p class="text-muted mb-0">Delivery Rate</p>
                </div>
            </div>
            <div class="col-md-3 col-6">
                <div class="stat-item">
                    <h2 class="display-4 fw-bold text-info mb-2">5K+</h2>
                    <p class="text-muted mb-0">Active Users</p>
                </div>
            </div>
            <div class="col-md-3 col-6">
                <div class="stat-item">
                    <h2 class="display-4 fw-bold text-warning mb-2">24/7</h2>
                    <p class="text-muted mb-0">Support</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Pricing Section -->
<section id="pricing" class="pricing-section py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="display-5 fw-bold mb-3">Simple, Transparent Pricing</h2>
            <p class="lead text-muted">Choose the plan that fits your business needs</p>
        </div>
        
        <div id="pricing-plans" class="row g-4 justify-content-center">
            <!-- Pricing plans will be loaded dynamically -->
            <div class="col-12 text-center">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading pricing plans...</span>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section py-5 bg-primary text-white">
    <div class="container text-center py-5">
        <h2 class="display-5 fw-bold mb-4">Ready to Transform Your Marketing?</h2>
        <p class="lead mb-4">Join thousands of businesses using our platform to grow their reach</p>
        <a href="@Url.Action("Register", "Auth")" class="btn btn-light btn-lg px-5">
            <i class="bi bi-rocket-takeoff"></i> Start Free Trial
        </a>
    </div>
</section>

@section Scripts {
    <script nonce="@Context.GetCspNonce()">
        const apiBaseUrl = '@ViewBag.ApiBaseUrl';

        // Load pricing plans on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadPricingPlans();
        });

        async function loadPricingPlans() {
            const container = document.getElementById('pricing-plans');
            
            try {
                // Fetch plans from API that are marked to show on landing page
                const response = await fetch(`${apiBaseUrl}/subscriptionplans/landing`);
                
                if (!response.ok) {
                    throw new Error('Failed to load pricing plans');
                }

                const result = await response.json();
                
                if (result.success && result.data && result.data.length > 0) {
                    renderPricingPlans(result.data);
                } else {
                    container.innerHTML = `
                        <div class="col-12">
                            <div class="alert alert-info text-center">
                                <i class="bi bi-info-circle"></i> No pricing plans available at this time.
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Error loading pricing plans:', error);
                container.innerHTML = `
                    <div class="col-12">
                        <div class="alert alert-warning text-center">
                            <i class="bi bi-exclamation-triangle"></i> Unable to load pricing plans at this time.
                        </div>
                    </div>
                `;
            }
        }

        function renderPricingPlans(plans) {
            const container = document.getElementById('pricing-plans');
            
            let html = '';
            plans.forEach((plan, index) => {
                // Parse features from JSON string if needed
                let features = [];
                try {
                    features = plan.features ? (typeof plan.features === 'string' ? JSON.parse(plan.features) : plan.features) : [];
                } catch (e) {
                    console.error('Error parsing features for plan:', plan.name, e);
                    features = [];
                }

                // Determine if plan is popular (middle plan typically)
                const isPopular = index === Math.floor(plans.length / 2);
                const popularBadge = isPopular ? '<div class="position-absolute top-0 start-50 translate-middle"><span class="badge bg-warning text-dark">Most Popular</span></div>' : '';
                const cardClass = isPopular ? 'border-primary shadow-lg' : 'border-0 shadow-sm';
                
                html += `
                    <div class="col-lg-4 col-md-6">
                        <div class="card h-100 ${cardClass} position-relative">
                            ${popularBadge}
                            <div class="card-body p-4">
                                <h3 class="card-title text-center mb-3">${escapeHtml(plan.name)}</h3>
                                <p class="text-muted text-center mb-4">${escapeHtml(plan.description || '')}</p>
                                <div class="text-center mb-4">
                                    <span class="display-4 fw-bold">$${plan.priceMonthly ? plan.priceMonthly.toFixed(2) : '0.00'}</span>
                                    <span class="text-muted">/month</span>
                                </div>
                                <ul class="list-unstyled mb-4">
                                    ${features.map(feature => `
                                        <li class="mb-2">
                                            <i class="bi bi-check-circle-fill text-success me-2"></i>
                                            ${escapeHtml(feature)}
                                        </li>
                                    `).join('')}
                                    ${features.length === 0 ? '<li class="text-muted">No features listed</li>' : ''}
                                </ul>
                                <div class="text-center">
                                    <a href="/Auth/Register?plan=${plan.id}" class="btn ${isPopular ? 'btn-primary' : 'btn-outline-primary'} w-100">
                                        Choose ${escapeHtml(plan.name)}
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
}

